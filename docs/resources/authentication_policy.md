---
page_title: "snowflake_authentication_policy Resource - terraform-provider-snowflake"
subcategory: "Preview"
description: |-
  Resource used to manage authentication policy objects. For more information, check authentication policy documentation https://docs.snowflake.com/en/sql-reference/sql/create-authentication-policy.
---

!> **Caution: Preview Feature** This feature is considered a preview feature in the provider, regardless of the state of the resource in Snowflake. We do not guarantee its stability. It will be reworked and marked as a stable feature in future releases. Breaking changes are expected, even without bumping the major version. To use this feature, add the relevant feature name to `preview_features_enabled` field in the [provider configuration](https://registry.terraform.io/providers/snowflakedb/snowflake/latest/docs#schema). Please always refer to the [Getting Help](https://github.com/snowflakedb/terraform-provider-snowflake?tab=readme-ov-file#getting-help) section in our Github repo to best determine how to get help for your questions.

!> **Note** According to Snowflake [docs](https://docs.snowflake.com/en/sql-reference/sql/drop-authentication-policy#usage-notes), an authentication policy cannot be dropped successfully if it is currently assigned to another object. Currently, the provider does not unassign such objects automatically. Before dropping the resource, first unassign the policy from the relevant objects. See [guide](../guides/unassigning_policies) for more details.

-> **Note** External changes are not detected for the following fields: `mfa_policy`, `pat_policy`, `workload_identity_policy`. Also, these values are not propagated as field values during the import. They are only available through the `describe_output` field.

# snowflake_authentication_policy (Resource)

Resource used to manage authentication policy objects. For more information, check [authentication policy documentation](https://docs.snowflake.com/en/sql-reference/sql/create-authentication-policy).

## Example Usage

```terraform
## Minimal
resource "snowflake_authentication_policy" "basic" {
  database = "database_name"
  schema   = "schema_name"
  name     = "network_policy_name"
}

## Complete (with every optional set)
resource "snowflake_authentication_policy" "complete" {
  database               = "database_name"
  schema                 = "schema_name"
  name                   = "network_policy_name"
  authentication_methods = ["ALL"]
  mfa_enrollment         = "OPTIONAL"
  client_types           = ["ALL"]
  security_integrations  = ["ALL"]

  mfa_policy = {
    allowed_methods                        = ["PASSKEY", "DUO"]
    enforce_mfa_on_external_authentication = "ALL"
  }
  pat_policy = {
    default_expiry_in_days    = 1
    max_expiry_in_days        = 30
    network_policy_evaluation = "NOT_ENFORCED"
  }
  workload_identity_policy = {
    allowed_providers     = ["ALL"]
    allowed_aws_accounts  = ["111122223333"]
    allowed_azure_issuers = ["https://login.microsoftonline.com/tenantid/v2.0"]
    allowed_oidc_issuers  = ["https://example.com"]
  }
  comment = "My authentication policy."
}
```

-> **Note** Instead of using fully_qualified_name, you can reference objects managed outside Terraform by constructing a correct ID, consult [identifiers guide](../guides/identifiers_rework_design_decisions#new-computed-fully-qualified-name-field-in-resources).
<!-- TODO(SNOW-1634854): include an example showing both methods-->

-> **Note** If a field has a default value, it is shown next to the type in the schema.

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `database` (String) The database in which to create the authentication policy. Due to technical limitations (read more [here](../guides/identifiers_rework_design_decisions#known-limitations-and-identifier-recommendations)), avoid using the following characters: `|`, `.`, `"`.
- `name` (String) Specifies the identifier for the authentication policy. Due to technical limitations (read more [here](../guides/identifiers_rework_design_decisions#known-limitations-and-identifier-recommendations)), avoid using the following characters: `|`, `.`, `"`.
- `schema` (String) The schema in which to create the authentication policy. Due to technical limitations (read more [here](../guides/identifiers_rework_design_decisions#known-limitations-and-identifier-recommendations)), avoid using the following characters: `|`, `.`, `"`.

### Optional

- `authentication_methods` (Set of String) A list of authentication methods that are allowed during login. Valid values are (case-insensitive): `ALL` | `SAML` | `PASSWORD` | `OAUTH` | `KEYPAIR` | `PROGRAMMATIC_ACCESS_TOKEN` | `WORKLOAD_IDENTITY`.
- `client_types` (Set of String) A list of clients that can authenticate with Snowflake. If a client tries to connect, and the client is not one of the valid `client_types`, then the login attempt fails. Valid values are (case-insensitive): `ALL` | `SNOWFLAKE_UI` | `DRIVERS` | `SNOWSQL` | `SNOWFLAKE_CLI`. The `client_types` property of an authentication policy is a best effort method to block user logins based on specific clients. It should not be used as the sole control to establish a security boundary.
- `comment` (String) Specifies a comment for the authentication policy.
- `mfa_authentication_methods` (Set of String, Deprecated) A list of authentication methods that enforce multi-factor authentication (MFA) during login. Authentication methods not listed in this parameter do not prompt for multi-factor authentication. Allowed values are `ALL` | `SAML` | `PASSWORD`.
- `mfa_enrollment` (String) Determines whether a user must enroll in multi-factor authentication. Valid values are (case-insensitive): `REQUIRED` | `REQUIRED_PASSWORD_ONLY` | `OPTIONAL`. When REQUIRED is specified, Enforces users to enroll in MFA. If this value is used, then the `client_types` parameter must include `snowflake_ui`, because Snowsight is the only place users can enroll in multi-factor authentication (MFA).
- `mfa_policy` (Block List, Max: 1) Specifies the multi-factor authentication (MFA) methods that users can use as a second factor of authentication. (see [below for nested schema](#nestedblock--mfa_policy))
- `pat_policy` (Block List, Max: 1) Specifies the policy for programmatic access tokens. (see [below for nested schema](#nestedblock--pat_policy))
- `security_integrations` (Set of String) A list of security integrations the authentication policy is associated with. This parameter has no effect when `saml` or `oauth` are not in the `authentication_methods` list. All values in the `security_integrations` list must be compatible with the values in the `authentication_methods` list. For example, if `security_integrations` contains a SAML security integration, and `authentication_methods` contains OAUTH, then you cannot create the authentication policy. To allow all security integrations use `all` as parameter.
- `timeouts` (Block, Optional) (see [below for nested schema](#nestedblock--timeouts))
- `workload_identity_policy` (Block List, Max: 1) Specifies the policy for workload identity federation. (see [below for nested schema](#nestedblock--workload_identity_policy))

### Read-Only

- `describe_output` (List of Object) Outputs the result of `DESCRIBE AUTHENTICATION POLICY` for the given policy. (see [below for nested schema](#nestedatt--describe_output))
- `fully_qualified_name` (String) Fully qualified name of the resource. For more information, see [object name resolution](https://docs.snowflake.com/en/sql-reference/name-resolution).
- `id` (String) The ID of this resource.
- `show_output` (List of Object) Outputs the result of `SHOW AUTHENTICATION POLICIES` for the given policy. (see [below for nested schema](#nestedatt--show_output))

<a id="nestedblock--mfa_policy"></a>
### Nested Schema for `mfa_policy`

Optional:

- `allowed_methods` (Set of String) Specifies the allowed methods for the MFA policy. Valid values are (case-insensitive): `ALL` | `PASSKEY` | `TOTP` | `DUO`.
- `enforce_mfa_on_external_authentication` (String) Determines whether multi-factor authentication (MFA) is enforced on external authentication. Valid values are (case-insensitive): `ALL` | `NONE`.


<a id="nestedblock--pat_policy"></a>
### Nested Schema for `pat_policy`

Optional:

- `default_expiry_in_days` (Number) Specifies the default expiration time (in days) for a programmatic access token.
- `max_expiry_in_days` (Number) Specifies the maximum number of days that can be set for the expiration time for a programmatic access token.
- `network_policy_evaluation` (String) Specifies the network policy evaluation for the PAT.


<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String)
- `delete` (String)
- `read` (String)
- `update` (String)


<a id="nestedblock--workload_identity_policy"></a>
### Nested Schema for `workload_identity_policy`

Optional:

- `allowed_aws_accounts` (List of String) Specifies the list of AWS account IDs allowed by the authentication policy during workload identity authentication of type `AWS`.
- `allowed_azure_issuers` (List of String) Specifies the list of Azure Entra ID issuers allowed by the authentication policy during workload identity authentication of type `AZURE`.
- `allowed_oidc_issuers` (List of String) Specifies the list of OIDC issuers allowed by the authentication policy during workload identity authentication of type `OIDC`.
- `allowed_providers` (Set of String) Specifies the allowed providers for the workload identity policy.


<a id="nestedatt--describe_output"></a>
### Nested Schema for `describe_output`

Read-Only:

- `authentication_methods` (String)
- `client_types` (String)
- `comment` (String)
- `mfa_authentication_methods` (String)
- `mfa_enrollment` (String)
- `mfa_policy` (String)
- `name` (String)
- `owner` (String)
- `pat_policy` (String)
- `security_integrations` (String)
- `workload_identity_policy` (String)


<a id="nestedatt--show_output"></a>
### Nested Schema for `show_output`

Read-Only:

- `comment` (String)
- `created_on` (String)
- `database_name` (String)
- `kind` (String)
- `name` (String)
- `options` (String)
- `owner` (String)
- `owner_role_type` (String)
- `schema_name` (String)

## Import

Import is supported using the following syntax:

```shell
terraform import snowflake_authentication_policy.example '"<database_name>"."<schema_name>"."<authentication_policy_name>"'
```
