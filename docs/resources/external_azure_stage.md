---
page_title: "snowflake_external_azure_stage Resource - terraform-provider-snowflake"
subcategory: "Preview"
description: |-
  Resource used to manage external Azure stages. For more information, check external stage documentation https://docs.snowflake.com/en/sql-reference/sql/create-stage#external-stage-parameters-externalstageparams.
---

!> **Caution: Preview Feature** This feature is considered a preview feature in the provider, regardless of the state of the resource in Snowflake. We do not guarantee its stability. It will be reworked and marked as a stable feature in future releases. Breaking changes are expected, even without bumping the major version. To use this feature, add the relevant feature name to `preview_features_enabled` field in the [provider configuration](https://registry.terraform.io/providers/snowflakedb/snowflake/latest/docs#schema). Please always refer to the [Getting Help](https://github.com/snowflakedb/terraform-provider-snowflake?tab=readme-ov-file#getting-help) section in our Github repo to best determine how to get help for your questions.

-> **Note** Temporary stages are not supported because they result in per-session objects.

-> **Note** External changes detection on `credentials.azure_sas_token`, and `encryption` fields are not supported due to Snowflake and Terraform limitations.

# snowflake_external_azure_stage (Resource)

Resource used to manage external Azure stages. For more information, check [external stage documentation](https://docs.snowflake.com/en/sql-reference/sql/create-stage#external-stage-parameters-externalstageparams).

## Example Usage

-> **Note** Instead of using fully_qualified_name, you can reference objects managed outside Terraform by constructing a correct ID, consult [identifiers guide](../guides/identifiers_rework_design_decisions#new-computed-fully-qualified-name-field-in-resources).
<!-- TODO(SNOW-1634854): include an example showing both methods-->

```terraform
# Basic resource with storage integration
resource "snowflake_external_azure_stage" "basic" {
  name                = "my_azure_stage"
  database            = "my_database"
  schema              = "my_schema"
  url                 = "azure://myaccount.blob.core.windows.net/mycontainer"
  storage_integration = snowflake_storage_integration.azure.name
}

# Complete resource with all options
resource "snowflake_external_azure_stage" "complete" {
  name                = "complete_azure_stage"
  database            = "my_database"
  schema              = "my_schema"
  url                 = "azure://myaccount.blob.core.windows.net/mycontainer/path/"
  storage_integration = snowflake_storage_integration.azure.name

  encryption {
    azure_cse {
      master_key = var.azure_master_key
    }
  }

  directory {
    enable            = true
    refresh_on_create = true
    auto_refresh      = false
  }

  comment = "Fully configured Azure external stage"
}

# Resource with SAS token credentials instead of storage integration
resource "snowflake_external_azure_stage" "with_credentials" {
  name     = "azure_stage_with_sas"
  database = "my_database"
  schema   = "my_schema"
  url      = "azure://myaccount.blob.core.windows.net/mycontainer"

  credentials {
    azure_sas_token = var.azure_sas_token
  }
}

# Resource with encryption set to none
resource "snowflake_external_azure_stage" "no_encryption" {
  name                = "azure_stage_no_encryption"
  database            = "my_database"
  schema              = "my_schema"
  url                 = "azure://myaccount.blob.core.windows.net/mycontainer"
  storage_integration = snowflake_storage_integration.azure.name

  encryption {
    none {}
  }
}
```

-> **Note** If a field has a default value, it is shown next to the type in the schema.

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `database` (String) The database in which to create the stage. Due to technical limitations (read more [here](../guides/identifiers_rework_design_decisions#known-limitations-and-identifier-recommendations)), avoid using the following characters: `|`, `.`, `"`.
- `name` (String) Specifies the identifier for the stage; must be unique for the database and schema in which the stage is created. Due to technical limitations (read more [here](../guides/identifiers_rework_design_decisions#known-limitations-and-identifier-recommendations)), avoid using the following characters: `|`, `.`, `"`.
- `schema` (String) The schema in which to create the stage. Due to technical limitations (read more [here](../guides/identifiers_rework_design_decisions#known-limitations-and-identifier-recommendations)), avoid using the following characters: `|`, `.`, `"`.
- `url` (String) Specifies the URL for the Azure storage container (e.g., 'azure://account.blob.core.windows.net/container').

### Optional

- `comment` (String) Specifies a comment for the stage.
- `credentials` (Block List, Max: 1) Specifies the Azure SAS token credentials for the external stage. (see [below for nested schema](#nestedblock--credentials))
- `directory` (Block List, Max: 1) Directory tables store a catalog of staged files in cloud storage. (see [below for nested schema](#nestedblock--directory))
- `encryption` (Block List, Max: 1) Specifies the encryption settings for the Azure external stage. (see [below for nested schema](#nestedblock--encryption))
- `storage_integration` (String) Specifies the name of the storage integration used to delegate authentication responsibility to a Snowflake identity.
- `timeouts` (Block, Optional) (see [below for nested schema](#nestedblock--timeouts))
- `use_privatelink_endpoint` (String) (Default: fallback to Snowflake default - uses special value that cannot be set in the configuration manually (`default`)) Specifies whether to use a private link endpoint for Azure storage.

### Read-Only

- `cloud` (String) Specifies a cloud provider for the stage. This field is used for checking external changes and recreating the resources if needed.
- `describe_output` (List of Object) Outputs the result of `DESCRIBE STAGE` for the given stage. (see [below for nested schema](#nestedatt--describe_output))
- `fully_qualified_name` (String) Fully qualified name of the resource. For more information, see [object name resolution](https://docs.snowflake.com/en/sql-reference/name-resolution).
- `id` (String) The ID of this resource.
- `show_output` (List of Object) Outputs the result of `SHOW STAGES` for the given stage. (see [below for nested schema](#nestedatt--show_output))
- `stage_type` (String) Specifies a type for the stage. This field is used for checking external changes and recreating the resources if needed.

<a id="nestedblock--credentials"></a>
### Nested Schema for `credentials`

Required:

- `azure_sas_token` (String, Sensitive) Specifies the shared access signature (SAS) token for Azure.


<a id="nestedblock--directory"></a>
### Nested Schema for `directory`

Required:

- `enable` (Boolean) Specifies whether to enable a directory table on the external stage.

Optional:

- `auto_refresh` (String) (Default: fallback to Snowflake default - uses special value that cannot be set in the configuration manually (`default`)) Specifies whether Snowflake should enable triggering automatic refreshes of the directory table metadata.
- `notification_integration` (String) Specifies the name of the notification integration used to automatically refresh the directory table metadata.
- `refresh_on_create` (String) (Default: fallback to Snowflake default - uses special value that cannot be set in the configuration manually (`default`)) Specifies whether to automatically refresh the directory table metadata once, immediately after the stage is created.This field is used only when creating the object. Changes on this field are ignored after creation.


<a id="nestedblock--encryption"></a>
### Nested Schema for `encryption`

Optional:

- `azure_cse` (Block List, Max: 1) Azure client-side encryption using a master key. (see [below for nested schema](#nestedblock--encryption--azure_cse))
- `none` (Block List, Max: 1) No encryption. (see [below for nested schema](#nestedblock--encryption--none))

<a id="nestedblock--encryption--azure_cse"></a>
### Nested Schema for `encryption.azure_cse`

Required:

- `master_key` (String, Sensitive) Specifies the 128-bit or 256-bit client-side master key.


<a id="nestedblock--encryption--none"></a>
### Nested Schema for `encryption.none`



<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String)
- `delete` (String)
- `read` (String)
- `update` (String)


<a id="nestedatt--describe_output"></a>
### Nested Schema for `describe_output`

Read-Only:

- `directory_table` (List of Object) (see [below for nested schema](#nestedobjatt--describe_output--directory_table))

<a id="nestedobjatt--describe_output--directory_table"></a>
### Nested Schema for `describe_output.directory_table`

Read-Only:

- `auto_refresh` (Boolean)
- `enable` (Boolean)



<a id="nestedatt--show_output"></a>
### Nested Schema for `show_output`

Read-Only:

- `cloud` (String)
- `comment` (String)
- `created_on` (String)
- `database_name` (String)
- `directory_enabled` (Boolean)
- `endpoint` (String)
- `has_credentials` (Boolean)
- `has_encryption_key` (Boolean)
- `name` (String)
- `owner` (String)
- `owner_role_type` (String)
- `region` (String)
- `schema_name` (String)
- `storage_integration` (String)
- `type` (String)
- `url` (String)

## Import

Import is supported using the following syntax:

```shell
terraform import snowflake_external_azure_stage.example '"<database_name>"."<schema_name>"."<stage_name>"'
```
